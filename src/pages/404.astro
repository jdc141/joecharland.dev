---
import Layout from "../components/Layout.astro";
---

<Layout title="404 - Page Not Found">
  <section class="text-center py-20 md:py-32">
    <div class="animate-fade-in">
      <h1 class="text-6xl md:text-7xl font-bold mb-4 gradient-text">
        404
      </h1>
      <h2 class="text-2xl md:text-3xl font-bold mb-4">
        Page Not Found
      </h2>
      <p class="text-gray-400 mb-6">
        While you're here, want to play a game?
      </p>
      
      <!-- Mini Game -->
      <div class="max-w-2xl mx-auto mb-12">
        <div class="bg-gray-800/50 border border-gray-700 rounded-lg p-6">
          <div class="mb-4 flex justify-between items-center text-xs md:text-sm flex-wrap gap-2">
            <p class="text-gray-400">
              <span class="hidden md:inline">Press <kbd class="px-2 py-1 bg-gray-700 rounded text-xs">SPACE</kbd></span>
              <span class="md:hidden">Tap</span> to jump
            </p>
            <div class="flex gap-3 text-gray-400">
              <span>Score: <span id="score" class="text-white font-semibold">0</span></span>
              <span>üêü <span id="fishCount" class="text-blue-300 font-semibold">0</span></span>
              <span>‚≠ê <span id="starCount" class="text-yellow-300 font-semibold">0</span></span>
            </div>
          </div>
          <div class="relative isolate overflow-hidden rounded">
            <canvas id="gameCanvas" width="600" height="200" class="w-full bg-gray-900 rounded cursor-pointer touch-none select-none"></canvas>
            
            <!-- Instructions Overlay -->
            <div id="instructions" class="absolute inset-0 bg-gray-900/95 rounded flex items-center justify-center cursor-pointer z-20">
              <div class="text-center px-2">
                <h3 class="text-sm md:text-base font-bold mb-1.5 gradient-text-small">Arctic Adventure! üêß</h3>
                <div class="grid grid-cols-2 gap-x-2 gap-y-0.5 max-w-xs mx-auto mb-1.5 text-xs">
                  <div class="flex items-center gap-1">
                    <span class="text-sm">üêß</span>
                    <span class="text-gray-300">You</span>
                  </div>
                  <div class="flex items-center gap-1">
                    <span class="text-sm">üêª‚Äç‚ùÑÔ∏è</span>
                    <span class="text-gray-300">Avoid</span>
                  </div>
                  <div class="flex items-center gap-1">
                    <span class="text-sm">üêü</span>
                    <span class="text-gray-300">Super jump</span>
                  </div>
                  <div class="flex items-center gap-1">
                    <span class="text-sm">‚≠ê</span>
                    <span class="text-gray-300">+5 pts</span>
                  </div>
                </div>
                <p class="text-blue-400 animate-pulse text-xs">
                  <span class="hidden md:inline">Press SPACE</span>
                  <span class="md:hidden">Tap</span> to start!
                </p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Game Over Message - Outside game container -->
        <div id="gameOver" class="mt-6 hidden">
          <p class="text-sm text-red-400 mb-4">
            Game Over! <span class="hidden md:inline">Press SPACE</span><span class="md:hidden">Tap</span> to restart
          </p>
          <div id="gameOverCTA" class="bg-blue-600/20 border border-blue-500 rounded-lg p-4 max-w-md mx-auto">
            <p class="text-gray-300 mb-3">
              Seems like you're enjoying this game... ü§î
            </p>
            <p class="text-gray-300 mb-4">
              Maybe you'd enjoy <strong class="text-white">hiring me</strong> too?
            </p>
            <a href="/resume" 
               class="inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-500 px-5 py-2 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105 text-sm">
              <i class="fas fa-user-tie"></i>
              View Resume
            </a>
          </div>
        </div>
      </div>

      <div class="flex gap-4 justify-center flex-wrap mb-8">
        <a href="/" 
           class="bg-blue-600 hover:bg-blue-500 px-6 py-3 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-home mr-2"></i>
          Go Home
        </a>
        <a href="/projects" 
           class="border border-blue-600 hover:bg-blue-600/10 px-6 py-3 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-code mr-2"></i>
          Projects
        </a>
        <a href="/resume" 
           class="border border-gray-600 hover:bg-gray-700 px-6 py-3 rounded-lg font-semibold transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-file-alt mr-2"></i>
          Resume
        </a>
      </div>
    </div>
  </section>
</Layout>

<style>
  .gradient-text {
    background: linear-gradient(90deg, #0891b2, #06b6d4, #22d3ee, #67e8f9, #06b6d4, #0891b2);
    background-size: 300% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradient-flow 6s ease-in-out infinite;
  }

  @keyframes gradient-flow {
    0%, 100% { background-position: 0% center; }
    50% { background-position: 100% center; }
  }

  .gradient-text-small {
    background: linear-gradient(90deg, #0891b2, #06b6d4, #22d3ee, #67e8f9, #06b6d4, #0891b2);
    background-size: 300% auto;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradient-flow 6s ease-in-out infinite;
  }

  .animate-fade-in {
    animation: fadeIn 0.8s ease-out;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  kbd {
    font-family: monospace;
    font-size: 0.9em;
  }
</style>

<script>
  const canvas = document.getElementById('gameCanvas') as HTMLCanvasElement;
  const ctx = canvas.getContext('2d')!;
  const scoreEl = document.getElementById('score')!;
  const fishCountEl = document.getElementById('fishCount')!;
  const starCountEl = document.getElementById('starCount')!;
  const gameOverEl = document.getElementById('gameOver')!;
  const instructionsEl = document.getElementById('instructions')!;
  const gameOverCTA = document.getElementById('gameOverCTA')!;

  // Game state
  let score = 0;
  let fishCollected = 0;
  let starsCollected = 0;
  let gameOver = false;
  let gameStarted = false;

  // Player (penguin character)
  const player = {
    x: 50,
    y: 150,
    width: 30,
    height: 35,
    velocityY: 0,
    jumping: false
  };

  // Game objects
  let obstacles: Array<{ x: number; width: number; height: number }> = [];
  let powerUps: Array<{ x: number; y: number; width: number; height: number }> = [];
  let platforms: Array<{ x: number; y: number; width: number; height: number }> = [];
  let stars: Array<{ x: number; y: number; width: number; height: number }> = [];
  let frameCount = 0;
  let nextObstacleFrame = 150; // Random spawn timing
  const gravity = 0.35; // Reduced from 0.5 for smoother falling
  let jumpPower = -10;
  const normalJumpPower = -10;
  const superJumpPower = -14;
  const groundY = 170;
  let powerUpActive = false;
  let powerUpTimer = 0;

  // Jump function
  function jump() {
    if (!gameStarted) {
      // Hide instructions and start game
      instructionsEl.classList.add('hidden');
      gameStarted = true;
      gameLoop();
    } else if (gameOver) {
      resetGame();
    } else if (!player.jumping) {
      player.velocityY = jumpPower;
      player.jumping = true;
    }
  }

  // Keyboard controls
  document.addEventListener('keydown', (e) => {
    if (e.code === 'Space') {
      e.preventDefault();
      jump();
    }
  });

  // Touch/Click controls for mobile (canvas)
  canvas.addEventListener('click', (e) => {
    e.preventDefault();
    jump();
  });

  canvas.addEventListener('touchstart', (e) => {
    e.preventDefault();
    jump();
  });

  // Make instructions overlay tappable too
  if (instructionsEl) {
    instructionsEl.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      jump();
    }, true); // Use capture phase

    instructionsEl.addEventListener('touchstart', (e) => {
      e.preventDefault();
      e.stopPropagation();
      jump();
    }, true); // Use capture phase
  }

  function resetGame() {
    score = 0;
    fishCollected = 0;
    starsCollected = 0;
    gameOver = false;
    gameStarted = true;
    obstacles = [];
    powerUps = [];
    platforms = [];
    stars = [];
    player.y = groundY - player.height;
    player.velocityY = 0;
    player.jumping = false;
    frameCount = 0;
    nextObstacleFrame = 150;
    powerUpActive = false;
    powerUpTimer = 0;
    jumpPower = normalJumpPower;
    scoreEl.textContent = '0';
    fishCountEl.textContent = '0';
    starCountEl.textContent = '0';
    gameOverEl.classList.add('hidden');
    if (gameOverCTA) gameOverCTA.classList.add('hidden');
    instructionsEl.classList.add('hidden');
    gameLoop();
  }

  function gameLoop() {
    if (gameOver || !gameStarted) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Update player
    player.velocityY += gravity;
    player.y += player.velocityY;

    if (player.y >= groundY - player.height) {
      player.y = groundY - player.height;
      player.velocityY = 0;
      player.jumping = false;
    }

    // Draw player (penguin)
    drawPenguin(player.x, player.y);

    // Spawn obstacles and power-ups with random timing
    frameCount++;
    
    // Random obstacle spawning
    if (frameCount >= nextObstacleFrame) {
      obstacles.push({
        x: canvas.width,
        width: 35,
        height: 30
      });
      nextObstacleFrame = frameCount + Math.floor(Math.random() * 100 + 100); // 100-200 frames
    }
    
    // Spawn fish occasionally
    if (frameCount % 250 === 0) {
      powerUps.push({
        x: canvas.width,
        y: groundY - 80,
        width: 20,
        height: 15
      });
    }
    
    // Spawn platforms every so often
    if (frameCount % 300 === 0 && Math.random() > 0.5) {
      platforms.push({
        x: canvas.width,
        y: groundY - 60,
        width: 80,
        height: 10
      });
    }
    
    // Spawn stars after score reaches 10
    if (score >= 10 && frameCount % 350 === 0) {
      stars.push({
        x: canvas.width,
        y: groundY - 100,
        width: 20,
        height: 20
      });
    }
    
    // Update power-up timer
    if (powerUpActive) {
      powerUpTimer--;
      if (powerUpTimer <= 0) {
        powerUpActive = false;
        jumpPower = normalJumpPower;
      }
    }

    // Update and draw obstacles (polar bears)
    obstacles = obstacles.filter(obs => {
      obs.x -= 2; // Slowed down from 3 to 2 for better gameplay

      // Draw polar bear
      drawPolarBear(obs.x, groundY - obs.height);

      // Collision detection
      if (
        player.x < obs.x + obs.width - 5 &&
        player.x + player.width > obs.x + 5 &&
        player.y + player.height > groundY - obs.height + 5
      ) {
        gameOver = true;
        gameOverEl.classList.remove('hidden');
        if (gameOverCTA) gameOverCTA.classList.remove('hidden');
        return false;
      }

      // Remove off-screen obstacles and increment score
      if (obs.x + obs.width < 0) {
        score++;
        scoreEl.textContent = score.toString();
        return false;
      }

      return obs.x > -obs.width;
    });
    
    // Update and draw power-ups (fish)
    powerUps = powerUps.filter(fish => {
      fish.x -= 2; // Match obstacle speed
      
      // Draw fish
      drawFish(fish.x, fish.y);
      
      // Collision detection for power-up collection
      if (
        player.x < fish.x + fish.width &&
        player.x + player.width > fish.x &&
        player.y < fish.y + fish.height &&
        player.y + player.height > fish.y
      ) {
        // Activate super jump
        powerUpActive = true;
        powerUpTimer = 180; // 3 seconds at 60fps
        jumpPower = superJumpPower;
        fishCollected++;
        fishCountEl.textContent = fishCollected.toString();
        return false;
      }
      
      return fish.x > -fish.width;
    });

    // Update and draw platforms
    platforms = platforms.filter(plat => {
      plat.x -= 2;
      
      // Draw ice platform with gradient
      const gradient = ctx.createLinearGradient(plat.x, plat.y, plat.x, plat.y + plat.height);
      gradient.addColorStop(0, '#e0f2fe'); // light blue
      gradient.addColorStop(0.5, '#bae6fd'); // lighter blue
      gradient.addColorStop(1, '#7dd3fc'); // sky blue
      ctx.fillStyle = gradient;
      ctx.fillRect(plat.x, plat.y, plat.width, plat.height);
      
      // Add sparkle effect
      ctx.strokeStyle = '#f0f9ff';
      ctx.lineWidth = 1;
      ctx.strokeRect(plat.x, plat.y, plat.width, plat.height);
      
      // Platform collision (landing on top)
      if (
        player.x < plat.x + plat.width &&
        player.x + player.width > plat.x &&
        player.y + player.height >= plat.y &&
        player.y + player.height <= plat.y + plat.height + 5 &&
        player.velocityY >= 0
      ) {
        player.y = plat.y - player.height;
        player.velocityY = 0;
        player.jumping = false;
      }
      
      return plat.x > -plat.width;
    });

    // Update and draw stars
    stars = stars.filter(star => {
      star.x -= 2;
      
      // Draw star
      drawStar(star.x + star.width / 2, star.y + star.height / 2, 10);
      
      // Collision detection for star collection
      if (
        player.x < star.x + star.width &&
        player.x + player.width > star.x &&
        player.y < star.y + star.height &&
        player.y + player.height > star.y
      ) {
        starsCollected++;
        starCountEl.textContent = starsCollected.toString();
        score += 5; // Bonus points for stars
        scoreEl.textContent = score.toString();
        return false;
      }
      
      return star.x > -star.width;
    });

    // Draw ground line
    ctx.strokeStyle = '#4b5563';
    ctx.beginPath();
    ctx.moveTo(0, groundY);
    ctx.lineTo(canvas.width, groundY);
    ctx.stroke();

    if (!gameOver) {
      requestAnimationFrame(gameLoop);
    }
  }

  // Draw polar bear helper function
  function drawPolarBear(x: number, y: number) {
    // Body (white/cream)
    ctx.fillStyle = '#f3f4f6';
    ctx.beginPath();
    ctx.ellipse(x + 17, y + 18, 15, 12, 0, 0, Math.PI * 2);
    ctx.fill();
    
    // Head (white/cream)
    ctx.beginPath();
    ctx.arc(x + 17, y + 8, 10, 0, Math.PI * 2);
    ctx.fill();
    
    // Ears (white)
    ctx.beginPath();
    ctx.arc(x + 11, y + 3, 4, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.arc(x + 23, y + 3, 4, 0, Math.PI * 2);
    ctx.fill();
    
    // Eyes (black)
    ctx.fillStyle = '#000000';
    ctx.beginPath();
    ctx.arc(x + 14, y + 7, 1.5, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.arc(x + 20, y + 7, 1.5, 0, Math.PI * 2);
    ctx.fill();
    
    // Nose (black)
    ctx.beginPath();
    ctx.arc(x + 17, y + 11, 2, 0, Math.PI * 2);
    ctx.fill();
    
    // Legs (cream)
    ctx.fillStyle = '#f3f4f6';
    ctx.fillRect(x + 8, y + 25, 6, 5);
    ctx.fillRect(x + 20, y + 25, 6, 5);
  }
  
  // Draw fish helper function
  function drawFish(x: number, y: number) {
    // Body (orange)
    ctx.fillStyle = '#fb923c';
    ctx.beginPath();
    ctx.ellipse(x + 10, y + 7, 8, 5, 0, 0, Math.PI * 2);
    ctx.fill();
    
    // Tail (orange)
    ctx.beginPath();
    ctx.moveTo(x + 2, y + 7);
    ctx.lineTo(x, y + 3);
    ctx.lineTo(x, y + 11);
    ctx.closePath();
    ctx.fill();
    
    // Eye (white)
    ctx.fillStyle = '#ffffff';
    ctx.beginPath();
    ctx.arc(x + 14, y + 6, 2, 0, Math.PI * 2);
    ctx.fill();
    
    // Pupil (black)
    ctx.fillStyle = '#000000';
    ctx.beginPath();
    ctx.arc(x + 14, y + 6, 1, 0, Math.PI * 2);
    ctx.fill();
  }

  // Draw penguin helper function
  function drawPenguin(x: number, y: number) {
    const centerX = x + player.width / 2;
    
    // Body (black oval)
    ctx.fillStyle = '#1f2937';
    ctx.beginPath();
    ctx.ellipse(centerX, y + 20, 12, 15, 0, 0, Math.PI * 2);
    ctx.fill();
    
    // Belly (white oval)
    ctx.fillStyle = '#ffffff';
    ctx.beginPath();
    ctx.ellipse(centerX, y + 22, 8, 12, 0, 0, Math.PI * 2);
    ctx.fill();
    
    // Head (black circle)
    ctx.fillStyle = '#1f2937';
    ctx.beginPath();
    ctx.arc(centerX, y + 8, 8, 0, Math.PI * 2);
    ctx.fill();
    
    // Eyes (white)
    ctx.fillStyle = '#ffffff';
    ctx.beginPath();
    ctx.arc(centerX - 3, y + 7, 2, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.arc(centerX + 3, y + 7, 2, 0, Math.PI * 2);
    ctx.fill();
    
    // Pupils (black)
    ctx.fillStyle = '#000000';
    ctx.beginPath();
    ctx.arc(centerX - 3, y + 7, 1, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.arc(centerX + 3, y + 7, 1, 0, Math.PI * 2);
    ctx.fill();
    
    // Beak (orange)
    ctx.fillStyle = '#f97316';
    ctx.beginPath();
    ctx.moveTo(centerX, y + 10);
    ctx.lineTo(centerX - 3, y + 12);
    ctx.lineTo(centerX + 3, y + 12);
    ctx.closePath();
    ctx.fill();
    
    // Feet (orange)
    ctx.fillStyle = '#f97316';
    ctx.beginPath();
    ctx.ellipse(centerX - 5, y + 34, 3, 2, 0, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.ellipse(centerX + 5, y + 34, 3, 2, 0, 0, Math.PI * 2);
    ctx.fill();
    
    // Wings (black)
    ctx.fillStyle = '#1f2937';
    ctx.beginPath();
    ctx.ellipse(centerX - 11, y + 18, 3, 8, -0.3, 0, Math.PI * 2);
    ctx.fill();
    ctx.beginPath();
    ctx.ellipse(centerX + 11, y + 18, 3, 8, 0.3, 0, Math.PI * 2);
    ctx.fill();
  }

  // Draw star helper function
  function drawStar(cx: number, cy: number, radius: number) {
    const spikes = 5;
    const outerRadius = radius;
    const innerRadius = radius / 2;
    let rot = Math.PI / 2 * 3;
    const step = Math.PI / spikes;
    
    ctx.fillStyle = '#fbbf24';
    ctx.strokeStyle = '#f59e0b';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(cx, cy - outerRadius);
    
    for (let i = 0; i < spikes; i++) {
      let x = cx + Math.cos(rot) * outerRadius;
      let y = cy + Math.sin(rot) * outerRadius;
      ctx.lineTo(x, y);
      rot += step;
      
      x = cx + Math.cos(rot) * innerRadius;
      y = cy + Math.sin(rot) * innerRadius;
      ctx.lineTo(x, y);
      rot += step;
    }
    
    ctx.lineTo(cx, cy - outerRadius);
    ctx.closePath();
    ctx.fill();
    ctx.stroke();
  }

  // Initial draw
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawPenguin(player.x, groundY - player.height);
  ctx.strokeStyle = '#4b5563';
  ctx.beginPath();
  ctx.moveTo(0, groundY);
  ctx.lineTo(canvas.width, groundY);
  ctx.stroke();
</script>

